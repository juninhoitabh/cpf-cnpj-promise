!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("node-fetch"),require("cheerio")):"function"==typeof define&&define.amd?define(["node-fetch","cheerio"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).cpfCnpj=t(e.fetch,e.cheerio)}(this,function(e,t){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(e),n=r(t);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function a(c){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=c.apply(e,a);function o(e){s(n,t,r,o,i,"next",e)}function i(e){s(n,t,r,o,i,"throw",e)}o(void 0)})}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function p(e,t,r){return(p=d()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);n=new(Function.bind.apply(e,n));return r&&l(n,r.prototype),n}).apply(null,arguments)}function m(e){var n="function"==typeof Map?new Map:void 0;return(m=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return p(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)})(e)}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(r){var n=d();return function(){var e,t=f(r);return h(this,n?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function y(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(r){return new Promise(function(e,t){return Promise.resolve(r).then(t,e)})}var P=function(){u(i,m(Error));var o=v(i);function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.message,r=e.type,n=e.errors;return c(this,i),(e=o.call(this)).name="CpfCnpjPromiseError",e.message=t,e.type=r,e.errors=n,e}return i}(),R=function(){u(o,m(Error));var n=v(o);function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.message,r=e.service;return c(this,o),(e=n.call(this)).name="ServiceError",e.message=t,e.service=r,e}return o}(),C=function(){var e=a(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://www.receitaws.com.br/v1/cnpj/".concat(encodeURI(t)),n={method:"GET"},e.next=4,o.default(r,n).then(S).then(x).catch(E);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),S=function(e){if(!1===e.ok||200!==e.status)throw new Error("CNPJ não encontrado na base de dados da Receita WS.");return e.json()},x=function(e){return{name:e.nome,fantasy:e.fantasia,cep:e.cep,state:e.uf,city:e.municipio,neighborhood:e.bairro,street:e.logradouro,streetnumber:e.numero,complement:e.complemento,phone:e.telefone,mail:e.email,service:"receitaws"}},E=function(e){throw new R({message:e.response.data.message,service:"receitaws"})},j=function(){var e=a(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default("https://www2.fazenda.mg.gov.br/sol/ctrl/SOL/NFAE/SERVICO_027",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7,es;q=0.6","cache-control":"max-age=0","content-type":"application/x-www-form-urlencoded","sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://www2.fazenda.mg.gov.br/sol/ctrl/SOL/NFAE/SERVICO_027",referrerPolicy:"strict-origin-when-cross-origin",body:"ACAO=PROCURAR&unifwScrollTop=0&unifwScrollLeft=448&txtIndicadorUC=Requerer+NFA&numeroAbaAnterior=2&tipoDestinatario.identificador=4&produtorRuralLogado=false&tipoRequerente.desRequerente=Pessoa+Jur%EDdica+N%E3o+Inscrita&tipo.descricao=Sa%EDda&circulacao.desCirculacao=Interna&operacaoRequerimentoNFASimplificado=false&remetente.cpfCnpj=".concat(t,"&remetente.ie=&remetente.nome=&remetente.cpfResponsavel=&remetente.foneFax=&remetente.email=&enderecoRemetente.cep=&enderecoRemetente.pais=&enderecoRemetente.uf=&enderecoRemetente.idMunicipio=&enderecoRemetente.municipio=&enderecoRemetente.distrito=&enderecoRemetente.bairro=&enderecoRemetente.tipoLogradouro=&enderecoRemetente.logradouro=&enderecoRemetente.numero=&enderecoRemetente.complemento1=&destinatario.cpfCnpj=&destinatario.ie=&destinatario.nome=&destinatario.foneFax=&enderecoDestinatario.cep=&enderecoDestinatario.pais=&enderecoDestinatario.uf=&enderecoDestinatario.idMunicipio=&enderecoDestinatario.municipio=&enderecoDestinatario.distrito=&enderecoDestinatario.bairro=&enderecoDestinatario.tipoLogradouro=&enderecoDestinatario.logradouro=&enderecoDestinatario.numero=&enderecoDestinatario.complemento1=&destinatario.tipoIdentificadorIeDestinatario.id=1&idMunicipioInicioTransp=&dsMunicipioInicioTransp="),method:"POST",mode:"cors"}).then(O).then(_).catch(A);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),O=function(e){if(!1===e.ok||200!==e.status)throw new Error("CPF/CNPJ não encontrado na base do Siare.");return e.text()},_=function(e){var t=n.default.load(e),r=t("div.boxConteudo table").eq(2),e=t(r).find("tr:nth-child(3)  td:nth-child(2) span span").html();if(e){r=t("div.boxConteudo table").eq(3);return{name:e.trim(),fantasy:e.trim(),cep:t(r).find("tr:nth-child(2) td:nth-child(2) span span").html(),state:t(r).find("tr:nth-child(3) td:nth-child(2) span span").html(),city:t(r).find("tr:nth-child(3) td:nth-child(4) span span").html(),neighborhood:t(r).find("tr:nth-child(5) td:nth-child(2) span span").html().trim(),street:(t(r).find("tr:nth-child(6) td:nth-child(2) span span").html()+" "+t(r).find("tr:nth-child(6) td:nth-child(4) span span").html()).trim(),streetnumber:t(r).find("tr:nth-child(6) td:nth-child(5) span:nth-child(2) span").html().trim(),complement:t(r).find("tr:nth-child(7) td:nth-child(2) span span").html().trim(),phone:"",mail:"",service:"siare"}}throw new Error("CPF/CNPJ não encontrado na base de dados do Siare.")},A=function(e){var t=new R({message:e.message,service:"siare"});throw"FetchError"===e.name&&(t.message="Erro ao se conectar com o site Siare."),t},D=function(e){function t(e){var e=e.split(""),t=!0,r=e[0];return e.forEach(function(e){r!==e&&(t=!1),r=e}),t}function r(e,t,r){for(var n=1<arguments.length&&void 0!==t?t:10,o=2<arguments.length&&void 0!==r?r:0,i=0;i<e.length;i+=1)o+=e[i]*n,--n<2&&(n=9);return o=(o%=11)<2?0:11-o,"".concat(e).concat(o)}var n,o,i,a,c,s=11===(n=e.trim().replace(/\D/g,"")).length?"CPF":14===n.length&&"CNPJ";return"CPF"===s?(i=(o=e).substring(0,9),i=r(i),i=r(i,11),!t(o)&&i===o):"CNPJ"===s&&(c=(a=e).substring(0,12),c=r(c,5),c=r(c,6),!t(a)&&c===a)};Promise.any=function(e){return w(Promise.all(y(e).map(w)))};var F=Promise,q=11,I=14;function N(){return(N=a(regeneratorRuntime.mark(function e(t){var r,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<n.length&&void 0!==n[1]?n[1]:{},e.next=3,F.resolve(t).then(J).then(function(e){return r.providers=r.providers||[],T(r.providers),e}).then(M).then(z).then(function(e){return L(e,r)}).catch(k).catch(U);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var T=function(e){var t=["receitaws","siare"];if(!Array.isArray(e))throw new P({message:"Erro ao inicializar a instância do CPFCNPJPromise.",type:"validation_error",errors:[{message:"O parâmetro providers deve ser uma lista.",service:"providers_validation"}]});var r=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=g(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}(e);try{for(r.s();!(n=r.n()).done;){var n=n.value;if(!t.includes(n))throw new P({message:"Erro ao inicializar a instância do CPFCNPJPromise.",type:"validation_error",errors:[{message:'O provider "'.concat(n,'" é inválido. Os providers disponíveis são: ["').concat(t.join('", "'),'"].'),service:"providers_validation"}]});return n}}catch(e){r.e(e)}finally{r.f()}},J=function(e){var t=i(e);if("number"===t||"string"===t)return e;throw new P({message:"Erro ao inicializar a instância do CPFCNPJPromise.",type:"validation_error",errors:[{message:"Você deve chamar o construtor utilizando uma String ou um Number.",service:"cpf_cnpj_validation"}]})},M=function(e){return e.toString().replace(/\D/g,"")};function z(e){var t=null,r=null,r=e.length===q?(t="CPF",q):e.length===I?(t="CNPJ",I):(t="CPF/CNPJ","".concat(q," caracteres para CPF e ").concat(I," para CNPJ"));if(e.length!==q&&e.length!==I)throw new P({message:"".concat(t," deve conter ").concat(r,"!"),type:"validation_error",errors:[{message:"".concat(t," informado possui quantidade de caracteres inválido!"),service:"cpf_cnpj_validation"}]});if(!D(e))throw new P({message:"".concat(t," Inválido!"),type:"validation_error",errors:[{message:"".concat(t," Inválido!"),service:"cpf_cnpj_validation"}]});return e}var L=function(t,e){var r=11===t.length?{siare:j}:{receitaws:C,siare:j};return 0===e.providers.length?F.any(Object.values(r).map(function(e){return e(t)})):F.any(e.providers.map(function(e){return r[e](t)}))},k=function(e){if(void 0!==e.length)throw new P({message:"Todos os serviços de consulta retornaram erro.",type:"service_error",errors:e});throw e},U=function(e){var t=e.message,r=e.type,e=e.errors;throw new P({message:t,type:r,errors:e})};return function(e){return N.apply(this,arguments)}});